<!DOCTYPE html><html lang="zhCN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content="_FIS_构建工具_前端工具框架"><meta name="keywords" content=",百度前端团队,FIS,百度FIS,百度前端,fis,前端模块化,前端工程,性能优化,web performance"><title>插件开发API</title><meta name="author" content="fis team"><!-- Enable responsive viewport --><meta name="viewport" content="width=device-width,initial-scale=1"><link href="http://fex-team.github.io/fis-site/assets/themes//css/normalize.css" rel="stylesheet"><link href="http://fex-team.github.io/fis-site/assets/themes//css/main.css" rel="stylesheet"><!-- Custom styles --><link href="http://fex-team.github.io/fis-site/assets/themes//css/style.css?body=1" rel="stylesheet" type="text/css" media="all"><!--<link href="http://fex-team.github.io/fis-site/assets/themes//css/highlight/monokai_sublime.css" rel="stylesheet" type="text/css" media="all">--><link href="http://fex-team.github.io/fis-site/assets/themes//css/pygments/github.css" rel="stylesheet" type="text/css" media="all"><link href="http://fex-team.github.io/fis-site/assets/themes//css/perfect-scrollbar.min.css" rel="stylesheet"><link href="http://fex-team.github.io/fis-site/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css" media="all"><script type="text/javascript"></script><!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries --><!-- WARNING: Respond.js doesn't work if you view the page via file:// --><!--[if lt IE 9]>
    <script src="http://fex-team.github.io/fis-site/assets/themes//js/html5shiv.js"></script>
    <script src="http://fex-team.github.io/fis-site/assets/themes//js/respond.min.js"></script>
    <![endif]--><!-- Fav and touch icons --><!-- Update these with your own images
      <link rel="shortcut icon" href="images/favicon.ico">
      <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
      <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    --><script src="http://fex-team.github.io/fis-site/assets/themes//js/jquery.min.js"></script><script src="http://fex-team.github.io/fis-site/assets/themes//js/scrollspy.js"></script></head><body><header class="navbar"><section><a href="/fis-site/index.html"><div class="logo"><i class="fa fa-cogs"></i> F.I.S - 前端工具框架</div></a><div class="nav-items"><a href="/fis-site/index.html"><div class="nav-item">首页</div></a> <a href="/fis-site/docs/beginning/getting-started.html"><div class="nav-item">使用文档</div></a> <a href="http://oak.baidu.com"><div class="nav-item">解决方案</div></a> <a target="_blank" href="http://www.imooc.com/learn/220"><div class="nav-item">在线课程</div></a> <a target="_blank" href="http://fex.baidu.com"><div class="nav-item">FEX官网</div></a></div></section></header><div id="wrap"><aside><nav class="sidebar"><ul><li class="item-category"><a href="/fis-site/docs/beginning/getting-started.html">快速入门</a></li><li class="item-sub"><a href="/fis-site/docs/beginning/getting-started.html#optimize">资源压缩</a></li><li class="item-sub"><a href="/fis-site/docs/beginning/getting-started.html#combine">资源合并</a></li><li class="item-sub"><a href="/fis-site/docs/beginning/assist.html">辅助开发</a></li><li class="item-sub"><a href="/fis-site/docs/api/cli.html">命令行</a></li><li class="item-category"><span>进阶使用</span></li><li class="item-sub"><a href="/fis-site/docs/more/fis-standard.html#资源定位">资源定位</a></li><li class="item-sub"><a href="/fis-site/docs/more/fis-standard.html#内容嵌入">内容嵌入</a></li><li class="item-sub"><a href="/fis-site/docs/more/fis-standard.html#依赖声明">依赖声明</a></li><li class="item-sub"><a href="/fis-site/docs/advance/roadmap.html">roadmap详解</a></li><li class="item-sub"><a href="/fis-site/docs/advance/modjs-solution.html">前端模块化</a></li><li class="item-sub"><a href="/fis-site/docs/advance/plugin-list.html">更多插件</a></li><li class="item-category"><a href="/fis-site/docs/dev/intro.html">二次开发</a></li><li class="item-sub"><a href="/fis-site/docs/dev/plugin.html">插件开发</a></li><li class="item-sub"><a href="/fis-site/docs/dev/solution.html">解决方案封装</a></li><li class="item-category"><a href="/fis-site/docs/dev/more.html">更多文档</a></li><li class="item-category"><a href="/fis-site/docs/api/fis-conf.html">配置API</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html">配置文件</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#project">project</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#modules">modules</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#settings">settings</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#roadmap">roadmap</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#pack">pack</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#deploy">deploy</a></li><li class="item-category"><a href="/fis-site/docs/api/dev.html">插件开发API</a></li><li class="item-category"><a href="/fis-sitehttps://github.com/fex-team/fis/issues/new">问题反馈</a></li><li class="item-category"><a href="/fis-sitehttps://github.com/fex-team/fis/issues?labels=faq&page=1&state=open">FAQ</a></li></ul></nav><div class="bottom-shadow"></div></aside><div class="container"><article class="doc-content"><div class="toc affix"></div><h1>插件开发API</h1><p>插件开发中需要用到的一些接口。</p><blockquote><p>如果说明还是不够清晰，nodejs里面查看方法最好最容易的方法就是require这个包，并<code>console.log</code>出来。这样就可以一个一个尝试效果。</p><blockquote><p>#打开node交互命令行。<br>$ node<br>&gt; var fis = require(&quot;fis&quot;);<br>&gt; console.log(fis.file);</p></blockquote></blockquote><h2>Object-Oriented</h2><p>FIS在OO这块扩展了Object，给其添加了一个派生方法<code>Object.derive</code>。细节就不说了，直接来看使用。</p><p>定义一个Object</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript">
<span class="kd">var</span> <span class="nx">Foo</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">derive</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//constructor</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="c1">//extend</span>
<span class="p">});</span>

</code></pre></div><p>使用Object</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Foo</span><span class="p">();</span>
</code></pre></div><h2>fis.util</h2><p><code>fis.util</code>包含了很多有用的工具方法，比如转码、读取文件、map等。</p><h3>is(source, type)</h3><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s1">'fis'</span><span class="p">,</span> <span class="s1">'String'</span><span class="p">);</span>
<span class="c1">// =&gt; true</span>
</code></pre></div><h3>map(obj, callback)</h3><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
<span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">key</span> <span class="o">+</span> <span class="s1">' =&gt; '</span> <span class="o">+</span> <span class="nx">value</span><span class="p">);</span>
<span class="p">})</span>
<span class="c1">// =&gt; </span>
<span class="c1">//  0 =&gt; 1 </span>
<span class="c1">//  1 =&gt; 2 </span>
<span class="c1">//  2 =&gt; 3</span>
</code></pre></div><h3>pad(str, len, fill, pre)</h3><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">pad</span><span class="p">(</span><span class="s1">'aaa'</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">);</span>
<span class="c1">// =&gt; aaa..</span>
<span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">pad</span><span class="p">(</span><span class="s1">'aaa'</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="c1">// =&gt; ..aaa</span>
</code></pre></div><h3>merge(source, target)</h3><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">key</span><span class="p">:</span> <span class="s1">'value'</span><span class="p">;</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">key1</span><span class="p">:</span> <span class="s1">'value1'</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">ab</span> <span class="o">=</span> <span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
<span class="c1">// =&gt; {key: 'value', key1: 'value1'}</span>
</code></pre></div><h3>clone(source)</h3><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span><span class="na">data</span><span class="p">:</span> <span class="s1">'string'</span><span class="p">};</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
<span class="nx">assert</span><span class="p">(</span><span class="nx">a</span> <span class="o">==</span> <span class="nx">b</span><span class="p">,</span> <span class="s1">'a != b'</span><span class="p">);</span>
<span class="c1">// =&gt; AssertionError: a != b</span>
</code></pre></div><h3>escapeReg(str)</h3><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">escapeReg</span><span class="p">(</span><span class="s1">'/home/fis/a.js'</span><span class="p">);</span>
<span class="c1">// =&gt; \\/home\\/fis\\/a\\.js</span>
</code></pre></div><h3>escapeShellCmd(str)</h3><h3>escapeShellArg(str)</h3><h3>stringQuote(str [, quotes])</h3><ul><li><code>str</code> String 字符串</li><li><code>quotes</code> String 引号</li></ul><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">stringQuote</span><span class="p">(</span><span class="s1">'"fis"'</span><span class="p">);</span>
<span class="c1">// =&gt; { origin: '"fis"', rest: 'fis', quote: '"' }</span>
</code></pre></div><h3>getMimeType(ext)</h3><ul><li><code>ext</code> String 文件后缀</li></ul><p>获取对于文件后缀的 MIME</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">getMimeType</span><span class="p">(</span><span class="s1">'png'</span><span class="p">)</span>
<span class="c1">// =&gt; image/png</span>
</code></pre></div><h3>realpath(path)</h3><ul><li><code>path</code> String</li></ul><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//cwd: /home/fis</span>
<span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">realpath</span><span class="p">(</span><span class="s1">'..'</span><span class="p">);</span>
<span class="c1">// =&gt; /home</span>
</code></pre></div><h3>realpathSafe(path)</h3><ul><li><code>path</code> String 路径</li></ul><p>安全得获取文件的实际路径，有别于 <a href="#realpath">realpath</a> 的是，其如果文件或者目录不存在返回 <code>false</code> 而此如果不存在返回传入的 <code>path</code> 。如果存在文件或者路径才返回实际路径。</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//cwd: /home/fis</span>
<span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">realpathSafe</span><span class="p">(</span><span class="s1">'../a.js'</span><span class="p">);</span>
<span class="c1">///home/a.js不存在</span>
<span class="c1">// =&gt; ../a.js</span>
</code></pre></div><h3>isAbsolute(path)</h3><ul><li><code>path</code> String 路径</li></ul><p>判别给定路径是否是绝对路径，是返回 <code>true</code> 不是返回 <code>false</code>。</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">isAbsolute</span><span class="p">(</span><span class="s1">'/usr/'</span><span class="p">);</span>
<span class="c1">// =&gt; true</span>
<span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">isAbsolute</span><span class="p">(</span><span class="s1">'/usr'</span><span class="p">);</span>
<span class="c1">// =&gt; false</span>
<span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">isAbsolute</span><span class="p">(</span><span class="s1">'usr/'</span><span class="p">);</span>
<span class="c1">// =&gt; false</span>
</code></pre></div><h3>isFile(path)</h3><ul><li><code>path</code> String 路径</li></ul><p>判别给定路径是否是一个文件，如果是返回 <code>true</code> 不是返回 <code>false</code>。</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">isFile</span><span class="p">(</span><span class="s1">'path/to/exist/file'</span><span class="p">));</span>
<span class="c1">// =&gt; true</span>
</code></pre></div><h3>isDir(path)</h3><ul><li><code>path</code> String 路径</li></ul><p>判别给定路径是否是一个文件夹，如果是返回 <code>true</code> 不是返回 <code>false</code>。</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">isDir</span><span class="p">(</span><span class="s1">'/tmp'</span><span class="p">));</span>
<span class="c1">// =&gt; true</span>
</code></pre></div><h3>mtime(path)</h3><ul><li><code>path</code> String 文件路径</li></ul><p>获取文件的最后修改时间</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">mtime</span><span class="p">(</span><span class="s1">'/tmp/debug/log.log'</span><span class="p">);</span>
<span class="c1">// =&gt; Tue Jun 16 2015 15:36:13 GMT+0800 (CST)</span>

<span class="kd">var</span> <span class="nx">mtime</span> <span class="o">=</span> <span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">mtime</span><span class="p">(</span><span class="s1">'/tmp/debug/log.log'</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">mtime</span> <span class="k">instanceof</span> <span class="nb">Date</span><span class="p">);</span>
<span class="c1">// =&gt; true</span>
</code></pre></div><h3>touch(path, mtime)</h3><ul><li><code>path</code> String 文件路径</li><li><code>mtime</code> Date 时间</li></ul><p>修改文件的最后修改时间，如果 <code>mtime</code> 未指定，使用当前时间；</p><h3>isWin()</h3><p>这个函数返回是否是 Windows 系统，如果是返回 <code>true</code> 如果不是返回 <code>false</code>。</p><h3>isTextFile()</h3><p>这个函数返回一个文件是否是文本文件，是返回 <code>true</code> 不是返回 <code>false</code>。FIS 中文件类型的判别是通过文件后缀做的。相关配置<a href="https://github.com/fex-team/fis/wiki/%E9%85%8D%E7%BD%AEAPI#projectfiletypetext">project.fileType.text</a></p><h3>isImageFile()</h3><p>这个函数返回一个文件是否是图片文件，是返回 <code>true</code> 不是返回 <code>false</code>，FIS 中文件类型的判别是通过文件后缀做的。相关配置<a href="https://github.com/fex-team/fis/wiki/%E9%85%8D%E7%BD%AEAPI#projectfiletypeimage">project.fileType.image</a></p><h3>md5(data, len)</h3><ul><li><code>data</code> String 文件内容</li><li><code>len</code> Int 最后获取文件的 md5 长度，默认长度为 7</li></ul><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">md5</span><span class="p">(</span><span class="s1">'fis'</span><span class="p">);</span> <span class="c1">//不设定len，默认7个。最长32个</span>
<span class="c1">// =&gt; 37ab815</span>
<span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">md5</span><span class="p">(</span><span class="s1">'fis'</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="c1">// =&gt; 37ab815c056b5c5f600f6ac93e486a78</span>
</code></pre></div><h3>base64(data)</h3><h3>mkdir(path, mode)</h3><h3>toEncoding(str, encoding)</h3><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">toEncoding</span><span class="p">(</span><span class="s1">'中文'</span><span class="p">,</span> <span class="s1">'gbk'</span><span class="p">);</span>
<span class="c1">// =&gt; &lt;Buffer d6 d0 ce c4&gt;</span>
</code></pre></div><h3>isUtf8(bytes)</h3><h3>readBuffer(buffer)</h3><h3>read(path, convert)</h3><h3>write(path, data, charset, append)</h3><h3>find(rPath, include, exclude)</h3><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'/home/fis'</span><span class="p">,</span> <span class="sr">/.*</span><span class="se">\.</span><span class="sr">js/</span><span class="p">);</span> <span class="c1">// all javascript file</span>
<span class="c1">// =&gt; [...]</span>
</code></pre></div><h3>del(rPath, include, exclude)</h3><h3>copy(rSource, target, include, exclude)</h3><h3>ext(str)</h3><h3>query(str)</h3><h3>pathinfo(path)</h3><h2>fis.config</h2><p><code>fis.config</code>提供了一个比较灵活的设置配置的方式。在<code>fis-conf.js</code>里面进行配置都可以在插件中拿到。</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'a.b.c'</span><span class="p">,</span> <span class="p">{</span><span class="na">e</span><span class="p">:</span><span class="s1">'0'</span><span class="p">});</span>
<span class="nx">fis</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'a'</span><span class="p">);</span>
<span class="c1">// =&gt; {b:{c:{e:'0'}}}</span>
<span class="nx">fis</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'a.b'</span><span class="p">);</span>
<span class="c1">// =&gt; {c:{e:'0'}}</span>
<span class="nx">fis</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'a.b.c'</span><span class="p">);</span>
<span class="c1">// =&gt; {e:'0'}</span>
</code></pre></div><h3>fis.config.merge(obj)</h3><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">merge</span><span class="p">({</span>
    <span class="na">namespace</span><span class="p">:</span> <span class="s1">'demo'</span>
<span class="p">});</span>
</code></pre></div><h3>fis.config.set(key, def)</h3><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'namespace'</span><span class="p">,</span> <span class="s1">'demo'</span><span class="p">);</span>
</code></pre></div><h3>fis.config.get(key)</h3><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">();</span> <span class="c1">//获取全部的配置信息</span>
<span class="nx">fis</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'namespace'</span><span class="p">)</span> <span class="c1">//获取namespace</span>
</code></pre></div><h2>fis.project</h2><h3>getProjectPath()</h3><p>获得项目路径</p><h3>setProjectRoot(rPath)</h3><ul><li><code>rPath</code> String 目录路径</li></ul><p>设置项目路径，如果设置的是一个不存在的目录路径，FIS 会自动创建它；</p><h2>fis.file</h2><p><code>fis.file</code>是一个比较主要的类型，每一个文件进入fis处理都会指向一个fis.file对象。可以获取文件的各种信息。比如修改事件、后缀、是否是文本、图片亦或是产出路径等等。</p><p>整个 FIS 编译阶段都是以 File 对象为基础进行编译的，所以的文件进入 FIS 编译都会被实例化成一个 File 对象；</p><h3>wrap(file)</h3><ul><li><code>file</code> String 文件路径</li></ul><p>实例化一个file对象</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">file</span> <span class="o">=</span> <span class="nx">fis</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="s1">'/home/fis/debug/static/demo.js'</span><span class="p">);</span>
</code></pre></div><h3>File 对象</h3><h4>isHtmlLike</h4><p>是否是类HTML文件，比如tpl</p><h4>isJsLike</h4><p>是否是类JS文件，比如coffeescript</p><h4>isCssLike</h4><p>是否是类CSS文件，比如less、sass</p><h4>requires</h4><p>文件依赖的id列表</p><h4>extras</h4><p>文件额外属性</p><h4>useMap</h4><p>是否记录到map.json</p><h4>isMod</h4><p>是否需要组件化</p><h4>exists()</h4><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">file</span><span class="p">.</span><span class="nx">exists</span><span class="p">();</span>
<span class="c1">// =&gt; true or false</span>
</code></pre></div><h4>isText()</h4><p>是否为一文本文件</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">file</span><span class="p">.</span><span class="nx">isText</span><span class="p">();</span>
<span class="c1">// =&gt; true or false</span>
</code></pre></div><h4>isImage()</h4><p>是否为一个图像文件</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">file</span><span class="p">.</span><span class="nx">isImage</span><span class="p">();</span>
<span class="c1">// =&gt; true or false</span>
</code></pre></div><h4>toString()</h4><p>file的真实路径</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">file</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
<span class="c1">// =&gt; /home/fis/debug/static/demo.js</span>
</code></pre></div><h4>getMtime()</h4><p>获取文件最后修改时间</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">mtime</span> <span class="o">=</span> <span class="nx">file</span><span class="p">.</span><span class="nx">getMtime</span><span class="p">();</span>
</code></pre></div><h4>setContent(c)</h4><ul><li><code>c</code> String / Buffer 文件内容</li></ul><p>设置文件内容</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">file</span><span class="p">.</span><span class="nx">setContent</span><span class="p">(</span><span class="s1">'content'</span><span class="p">);</span>
</code></pre></div><h4>getContent()</h4><p>获取文件内容</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">file</span><span class="p">.</span><span class="nx">getContent</span><span class="p">();</span>
</code></pre></div><h4>getHash()</h4><p>获取文件内容hash</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">hash</span> <span class="o">=</span> <span class="nx">file</span><span class="p">.</span><span class="nx">getHash</span><span class="p">();</span>
</code></pre></div><h4>getBase64(prefix)</h4><p>获取文件的base64</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">base64</span> <span class="o">=</span> <span class="nx">file</span><span class="p">.</span><span class="nx">getBase64</span><span class="p">();</span>
</code></pre></div><h4>getId()</h4><p>获取文件对应的ID</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">file</span><span class="p">.</span><span class="nx">getId</span><span class="p">();</span>
</code></pre></div><h4>getUrl(withHash, withDomain)</h4><ul><li><code>withHash</code> Boolean 文件 Url 是否包含 md5 戳</li><li><code>withDomain</code> Boolean 文件 Url 是否包含设置的 domain</li></ul><p>获取文件的url</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">file</span><span class="p">.</span><span class="nx">getUrl</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</code></pre></div><h4>addRequire(id)</h4><ul><li><code>id</code> String 文件 id，用 <a href="#gitid">getId()</a> 获得</li></ul><p>给文件添加依赖</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">file</span><span class="p">.</span><span class="nx">addRequire</span><span class="p">(</span><span class="s1">'a.js'</span><span class="p">);</span>
<span class="c1">// demo.js </span>
<span class="c1">//依赖与a.js</span>
</code></pre></div><h4>removeRequire(id)</h4><ul><li><code>id</code> String 文件 id，用 <a href="#gitid">getId()</a> 获得</li></ul><p>移除文件对某个其他文件的依赖</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">file</span><span class="p">.</span><span class="nx">removeRequire</span><span class="p">(</span><span class="s1">'a.js'</span><span class="p">);</span>
<span class="c1">// 移除对a.js的依赖</span>
</code></pre></div><h2>fis.compile</h2><p>编译一个文件，注意文件的缓存控制；</p><blockquote><p>注意，它是一个函数，而非对象</p></blockquote><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'path'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">file</span> <span class="o">=</span> <span class="nx">fis</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">fis</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">getProjectPath</span><span class="p">(),</span> <span class="s1">'a.js'</span><span class="p">));</span>
<span class="nx">file</span><span class="p">.</span><span class="nx">useCache</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span> <span class="c1">// @NOTICE</span>
<span class="nx">fis</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">getContent</span><span class="p">());</span>
</code></pre></div><h2>fis.log</h2><p>打印log，适合调试报错等</p><h3>debug(str)</h3><ul><li><code>str</code> String 要输出的调试信息</li></ul><p>输出一些调试信息，当执行 <code>release</code> 时，后面带命令行参数 <code>--verbose</code> 输出这些调试信息；</p><div class="highlight"><pre><code class="language-bash" data-lang="bash">fis release --verbose
</code></pre></div><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">fis</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="s1">'debugMessage'</span><span class="p">);</span>
<span class="c1">// [DEBUG] 18:49:46.0958 debugMessage</span>
</code></pre></div><h3>notice(str)</h3><ul><li><code>str</code> String 一些提示信息</li></ul><p>输出一些提示信息，调用了此方法会直接输出提示，不同于 <code>fis.debug()</code></p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">notice</span><span class="p">(</span><span class="s1">'noticeMessage'</span><span class="p">);</span>
<span class="c1">// [NOTICE] 18:49:46.0958 noticeMessage</span>
</code></pre></div><h3>warning(str)</h3><ul><li><code>str</code> String 一些警告信息</li></ul><p>输出一些警告信息，调用了就会输出，不同于 <code>fis.debug()</code></p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">warning</span><span class="p">(</span><span class="s1">'warningMessage'</span><span class="p">);</span>
<span class="c1">// [WARNING] 18:49:46.0958 warningMessage</span>
</code></pre></div><h3>error(err)</h3><ul><li><code>err</code> String / Error 错误信息</li></ul><p>输出错误信息接口，当 <code>release</code> 添加命令行参数 <code>--verbose</code> 会打出所有的错误堆栈信息。</p><p>调用此接口并被触发后，编译会中断，因为 <code>Error</code> 是一个不可挽回的错误。</p><div class="highlight"><pre><code class="language-bash" data-lang="bash">fis release --verbose
</code></pre></div><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fis</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'errorMessage'</span><span class="p">);</span>
<span class="c1">// [ERROR] 18:49:46.0958 errorMessage</span>
<span class="c1">// 编译中断</span>
</code></pre></div><!--  --><br><strong>有任何问题，请在 <a href="https://github.com/fex-team/fis/issues">https://github.com/fex-team/fis/issues</a> 讨论</strong></article><script type="text/javascript">$("a").each(function(t,e){0===$(e).attr("href").indexOf("/")?$(e).attr("href","http://fex-team.github.io/fis-site"+$(e).attr("href")):0!==$(e).attr("href").indexOf("#")&&$(e).attr("target","_blank")});</script><script type="text/javascript" src="http://fex-team.github.io/fis-site/assets/themes//js/document.js"></script></div></div><script type="text/javascript">var _bdhmProtocol="https:"==document.location.protocol?" https://":" http://";document.write(unescape("%3Cscript src='"+_bdhmProtocol+"hm.baidu.com/h.js%3F4206d67a3ea708c0d2a9354c8d88525f' type='text/javascript'%3E%3C/script%3E"));</script><!-- Latest compiled and minified JavaScript, requires jQuery 1.x (2.x not supported in IE8) --><!-- Placed at the end of the document so the pages load faster --><script src="http://fex-team.github.io/fis-site/assets/themes//js/perfect-scrollbar.min.js"></script><script type="text/javascript">!function(){function e(e,n){var i=$('<div style="display:none;"/>').appendTo($("body"));i.html("<!--[if "+(n||"")+" IE "+(e||"")+"]><a>&nbsp;</a><![endif]-->");var o=i.find("a").length;return i.remove(),o}function n(){function e(){i||(console.log("enable"),i=!0,$(".sidebar").perfectScrollbar({wheelSpeed:10,wheelPropagation:!1}))}function n(){i&&(console.log("disable"),i=!1,$(".sidebar").perfectScrollbar("destroy"))}$(window).width()>760&&$(".sidebar").height()<$(".sidebar ul").height()?e():n()}var i=!1;e(8,"lte")||($(".sidebar").addClass("scrollbar"),n(),$(window).resize(n))}();</script></body></html>