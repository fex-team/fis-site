<!DOCTYPE html><html lang="zhCN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content="_FIS_构建工具_前端工具框架"><meta name="keywords" content=",百度前端团队,FIS,百度FIS,百度前端,fis,前端模块化,前端工程,性能优化,web performance"><title>如何利用FIS构建纯前端模块化方案- F.I.S</title><meta name="author" content="fis team"><!-- Enable responsive viewport --><meta name="viewport" content="width=device-width,initial-scale=1"><link href="/assets/themes/css/normalize.css" rel="stylesheet"><link href="/assets/themes/css/main.css" rel="stylesheet"><!-- Custom styles --><link href="/assets/themes/css/style.css?body=1" rel="stylesheet" type="text/css" media="all"><!--<link href="/assets/themes//css/highlight/monokai_sublime.css" rel="stylesheet" type="text/css" media="all">--><link href="/assets/themes/css/pygments/github.css" rel="stylesheet" type="text/css" media="all"><link href="/assets/themes/css/perfect-scrollbar.min.css" rel="stylesheet"><link href="assets/css/font-awesome.min.css" rel="stylesheet" type="text/css" media="all"><script type="text/javascript"></script><!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries --><!-- WARNING: Respond.js doesn't work if you view the page via file:// --><!--[if lt IE 9]>
    <script src="/assets/themes/js/html5shiv.js"></script>
    <script src="/assets/themes/js/respond.min.js"></script>
    <![endif]--><!-- Fav and touch icons --><!-- Update these with your own images
      <link rel="shortcut icon" href="images/favicon.ico">
      <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
      <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    --><script src="/assets/themes/js/jquery.min.js"></script><script src="/assets/themes/js/scrollspy.js"></script></head><body><header class="navbar"><section><a href="/fis-site/index.html"><div class="logo"><i class="fa fa-cogs"></i> F.I.S - 前端工具框架</div></a><div class="nav-items"><a href="/fis-site/index.html"><div class="nav-item">首页</div></a> <a href="/fis-site/docs/beginning/getting-started.html"><div class="nav-item">使用文档</div></a> <a href="http://oak.baidu.com"><div class="nav-item">解决方案</div></a> <a target="_blank" href="http://www.imooc.com/learn/220"><div class="nav-item">在线课程</div></a> <a target="_blank" href="http://fex.baidu.com"><div class="nav-item">FEX官网</div></a></div></section></header><div id="wrap"><aside><nav class="sidebar"><ul><li class="item-category"><a href="/fis-site/docs/beginning/getting-started.html">快速入门</a></li><li class="item-sub"><a href="/fis-site/docs/beginning/getting-started.html#optimize">资源压缩</a></li><li class="item-sub"><a href="/fis-site/docs/beginning/getting-started.html#combine">资源合并</a></li><li class="item-sub"><a href="/fis-site/docs/beginning/assist.html">辅助开发</a></li><li class="item-sub"><a href="/fis-site/docs/api/cli.html">命令行</a></li><li class="item-category"><span>进阶使用</span></li><li class="item-sub"><a href="/fis-site/docs/more/fis-standard.html#资源定位">资源定位</a></li><li class="item-sub"><a href="/fis-site/docs/more/fis-standard.html#内容嵌入">内容嵌入</a></li><li class="item-sub"><a href="/fis-site/docs/more/fis-standard.html#依赖声明">依赖声明</a></li><li class="item-sub"><a href="/fis-site/docs/advance/roadmap.html">roadmap详解</a></li><li class="item-sub"><a href="/fis-site/docs/advance/modjs-solution.html">前端模块化</a></li><li class="item-sub"><a href="/fis-site/docs/advance/plugin-list.html">更多插件</a></li><li class="item-category"><a href="/fis-site/docs/dev/intro.html">二次开发</a></li><li class="item-sub"><a href="/fis-site/docs/dev/plugin.html">插件开发</a></li><li class="item-sub"><a href="/fis-site/docs/dev/solution.html">解决方案封装</a></li><li class="item-category"><a href="/fis-site/docs/dev/more.html">更多文档</a></li><li class="item-category"><a href="/fis-site/docs/api/fis-conf.html">配置API</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html">配置文件</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#project">project</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#modules">modules</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#settings">settings</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#roadmap">roadmap</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#pack">pack</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#deploy">deploy</a></li><li class="item-category"><a href="/fis-site/docs/api/dev.html">插件开发API</a></li><li class="item-category"><a href="/fis-sitehttps://github.com/fex-team/fis/issues/new">问题反馈</a></li><li class="item-category"><a href="/fis-sitehttps://github.com/fex-team/fis/issues?labels=faq&page=1&state=open">FAQ</a></li></ul></nav><div class="bottom-shadow"></div></aside><div class="container"><article class="doc-content"><div class="toc affix"></div><h1>如何利用FIS构建纯前端模块化方案</h1><h2>引言</h2><blockquote><p>随着现代互联网的快速发展，Web2.0、HTML5、Web App、Hybird App等技术或概念的引入，以及浏览器终端性能的提升，前端开发已经不再仅仅是对制作静态页面或者使用脚本添加一些动态效果和内容，而是承载了更多的业务逻辑与功能。</p><p>然而作为前端承载的基础，无论是HTTP协议、浏览器内核、JavaScript、CSS等技术，虽然已经有了长足的发展，但是仍然无法满足如今的前端需求，因此为了解决这些先天存在的前端语言能力和性能问题，解决各种问题的手段和框架也层出不穷。而前端模块化就是目前解决这些语言能力问题最热门也是最基础的方法之一。</p></blockquote><p>FIS在模块化思路上，没有考虑让前端承载过多的处理工作。实际上FIS除了拥有前端项目的压缩、合并等构建能力以外，还可以帮助你产出一份<a href="http://fex-team.github.io/fis-site/docs/more/mapjson.html">map.json</a>，这份文件是整个FIS模块化思想中非常重要的一环，它描述了整个项目的静态资源的情况，将工具与具体的静态资源管理框架<strong>解耦</strong>。</p><p>FIS更加推崇利用这份静态资源报表，配合后端模版框架层面来管理页面的静态资源。这种管理模式是非常具有想象力和扩展空间的，不仅更加利于实现模版、脚本、样式的整体模块化能力，并且可以对项目提供更细粒度和更加智能的静态资源管理能力。更加详细的思路和实现方法可以查看<a href="http://fex-team.github.io/fis-site/docs/dev/more.html">更多文档</a>中的前端工程化内容。</p><h2>模块化思路</h2><p>虽然FIS推荐采用后端扩展的形式来增强静态资源的管理能力，但是我们也意识到在不同的项目背景下，要求让大家立刻转为使用后端框架管理静态资源是非常困难和片面的。因此我们也结合FIS的静态资源管理思想，实现了一套在构建阶段就能完成静态资源管理的<strong>纯前端</strong>解决方案，同时又成功保留了简单的运行库、动态加载依赖、智能灵活的资源合并等FIS模块化思想的优势。</p><p>首先我们梳理一下模块化开发解决方案的基础目标</p><ol><li>能够像编写Nodejs一样编写前端代码，资源自动按需加载</li><li>不仅仅是脚本模块化能力，模块应该一体化管理脚本、样式、模板</li><li>能够提供自动化的性能优化能力，诸如资源压缩、MD5戳、资源合并等功能</li></ol><p>让我们一步步解决这些需求</p><p>由于FIS内置了<a href="http://fex-team.github.io/fis-site/docs/more/fis-standard-require.html">依赖声明</a>的语言能力，因此经过FIS构建的前端项目都会拥有一个带资源依赖关系的静态资源表</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
    <span class="s2">"res"</span> <span class="err">:</span> <span class="p">{</span>
        <span class="s2">"demo.css"</span> <span class="err">:</span> <span class="p">{</span>
            <span class="s2">"uri"</span> <span class="err">:</span> <span class="s2">"/static/css/demo_7defa41.css"</span><span class="p">,</span>
            <span class="s2">"type"</span> <span class="err">:</span> <span class="s2">"css"</span>
        <span class="p">},</span>
        <span class="s2">"demo.js"</span> <span class="err">:</span> <span class="p">{</span>
            <span class="s2">"uri"</span> <span class="err">:</span> <span class="s2">"/static/js/demo_33c5143.js"</span><span class="p">,</span>
            <span class="s2">"type"</span> <span class="err">:</span> <span class="s2">"js"</span><span class="p">,</span>
            <span class="s2">"deps"</span> <span class="err">:</span> <span class="p">[</span> <span class="s2">"demo.css"</span> <span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">"index.html"</span> <span class="err">:</span> <span class="p">{</span>
            <span class="s2">"uri"</span> <span class="err">:</span> <span class="s2">"/index.html"</span><span class="p">,</span>
            <span class="s2">"type"</span> <span class="err">:</span> <span class="s2">"html"</span><span class="p">,</span>
            <span class="s2">"deps"</span> <span class="err">:</span> <span class="p">[</span> <span class="s2">"demo.js"</span><span class="p">,</span> <span class="s2">"demo.css"</span> <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">"pkg"</span> <span class="err">:</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre></div><p>因此我们通过读取FIS产出的静态资源表可以直接获取到资源之间的依赖关系，我们就可以直接将这些资源按照依赖顺序注入到页面中即可。基于这个思路我们实现了一个用于自动加载模块化资源并注入页面的插件<a href="https://github.com/hefangshi/fis-postpackager-autoload">fis-postpackager-autoload</a>，它将提供页面级的资源自动加载能力。</p><p>相应的，我们还需要在前端使用一套类似AMD/CMD规范的模块化加载库<a href="https://github.com/fex-team/mod">Mod</a>，Mod的特点在于弱化了前端的依赖分析能力，通过FIS工具在构建时期完成这些繁重的工作。这样的优势是模块化加载库的功能更加单一，逻辑更加简单，并且将资源合并工作交给编译时或后端运行时解决，进一步降低复杂度。</p><p>但是光有这些，我们的资源都还是按照模块独立的进行加载，这样很明显是不符合我们的减少HTTP请求的目标的。这个问题听起来很耳熟，有没有想到如何解决？没错！就是使用我们在快速入门时介绍过的资源合并插件<a href="https://github.com/hefangshi/fis-postpackager-simple">fis-postpackager-simple</a>，通过autoload插件注入资源依赖，再通过simple插件合并资源依赖，我们就像<strong>拼积木</strong>一样通过FIS构建出了一套高可用性的前端模块化解决方案。而上述方案组合出来的解决方案就是<a href="http://fex-team.github.io/fis-site/docs/advance/modjs-solution.html">fis-pure</a>。</p><!--  --><br><strong>有任何问题，请在 <a href="https://github.com/fex-team/fis/issues">https://github.com/fex-team/fis/issues</a> 讨论</strong></article><script type="text/javascript">$("a").each(function(t,r){0===$(r).attr("href").indexOf("/")?$(r).attr("href",""+$(r).attr("href")):0!==$(r).attr("href").indexOf("#")&&$(r).attr("target","_blank")});</script><script type="text/javascript" src="/assets/themes/js/document.js"></script></div></div><script type="text/javascript">var _bdhmProtocol="https:"==document.location.protocol?" https://":" http://";document.write(unescape("%3Cscript src='"+_bdhmProtocol+"hm.baidu.com/h.js%3F4206d67a3ea708c0d2a9354c8d88525f' type='text/javascript'%3E%3C/script%3E"));</script><!-- Latest compiled and minified JavaScript, requires jQuery 1.x (2.x not supported in IE8) --><!-- Placed at the end of the document so the pages load faster --><script src="/assets/themes/js/perfect-scrollbar.min.js"></script><script type="text/javascript">!function(){function e(e,n){var i=$('<div style="display:none;"/>').appendTo($("body"));i.html("<!--[if "+(n||"")+" IE "+(e||"")+"]><a>&nbsp;</a><![endif]-->");var o=i.find("a").length;return i.remove(),o}function n(){function e(){i||(console.log("enable"),i=!0,$(".sidebar").perfectScrollbar({wheelSpeed:10,wheelPropagation:!1}))}function n(){i&&(console.log("disable"),i=!1,$(".sidebar").perfectScrollbar("destroy"))}$(window).width()>760&&$(".sidebar").height()<$(".sidebar ul").height()?e():n()}var i=!1;e(8,"lte")||($(".sidebar").addClass("scrollbar"),n(),$(window).resize(n))}();</script></body></html>