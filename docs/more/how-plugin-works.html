<!DOCTYPE html><html lang="zhCN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content="_FIS_构建工具_前端工具框架"><meta name="keywords" content=",百度前端团队,FIS,百度FIS,百度前端,fis,前端模块化,前端工程,性能优化,web performance"><title>插件调用机制- F.I.S</title><meta name="author" content="fis team"><!-- Enable responsive viewport --><meta name="viewport" content="width=device-width,initial-scale=1"><link href="/css/normalize.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><!-- Custom styles --><link href="/css/style.css?body=1" rel="stylesheet" type="text/css" media="all"><!--<link href="//css/highlight/monokai_sublime.css" rel="stylesheet" type="text/css" media="all">--><link href="/css/pygments/github.css" rel="stylesheet" type="text/css" media="all"><link href="/css/perfect-scrollbar.min.css" rel="stylesheet"><link href="assets/css/font-awesome.min.css" rel="stylesheet" type="text/css" media="all"><script type="text/javascript"></script><!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries --><!-- WARNING: Respond.js doesn't work if you view the page via file:// --><!--[if lt IE 9]>
    <script src="/js/html5shiv.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]--><!-- Fav and touch icons --><!-- Update these with your own images
      <link rel="shortcut icon" href="images/favicon.ico">
      <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
      <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    --><script src="/js/jquery.min.js"></script><script src="/js/scrollspy.js"></script></head><body><header class="navbar"><section><a href="/fis-site/index.html"><div class="logo"><i class="fa fa-cogs"></i> F.I.S - 前端工具框架</div></a><div class="nav-items"><a href="/fis-site/index.html"><div class="nav-item">首页</div></a> <a href="/fis-site/docs/beginning/getting-started.html"><div class="nav-item">使用文档</div></a> <a href="http://oak.baidu.com"><div class="nav-item">解决方案</div></a> <a target="_blank" href="http://www.imooc.com/learn/220"><div class="nav-item">在线课程</div></a> <a target="_blank" href="http://fex.baidu.com"><div class="nav-item">FEX官网</div></a></div></section></header><div id="wrap"><aside><nav class="sidebar"><ul><li class="item-category"><a href="/fis-site/docs/beginning/getting-started.html">快速入门</a></li><li class="item-sub"><a href="/fis-site/docs/beginning/getting-started.html#optimize">资源压缩</a></li><li class="item-sub"><a href="/fis-site/docs/beginning/getting-started.html#combine">资源合并</a></li><li class="item-sub"><a href="/fis-site/docs/beginning/assist.html">辅助开发</a></li><li class="item-sub"><a href="/fis-site/docs/api/cli.html">命令行</a></li><li class="item-category"><span>进阶使用</span></li><li class="item-sub"><a href="/fis-site/docs/more/fis-standard.html#资源定位">资源定位</a></li><li class="item-sub"><a href="/fis-site/docs/more/fis-standard.html#内容嵌入">内容嵌入</a></li><li class="item-sub"><a href="/fis-site/docs/more/fis-standard.html#依赖声明">依赖声明</a></li><li class="item-sub"><a href="/fis-site/docs/advance/roadmap.html">roadmap详解</a></li><li class="item-sub"><a href="/fis-site/docs/advance/modjs-solution.html">前端模块化</a></li><li class="item-sub"><a href="/fis-site/docs/advance/plugin-list.html">更多插件</a></li><li class="item-category"><a href="/fis-site/docs/dev/intro.html">二次开发</a></li><li class="item-sub"><a href="/fis-site/docs/dev/plugin.html">插件开发</a></li><li class="item-sub"><a href="/fis-site/docs/dev/solution.html">解决方案封装</a></li><li class="item-category"><a href="/fis-site/docs/dev/more.html">更多文档</a></li><li class="item-category"><a href="/fis-site/docs/api/fis-conf.html">配置API</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html">配置文件</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#project">project</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#modules">modules</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#settings">settings</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#roadmap">roadmap</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#pack">pack</a></li><li class="item-sub"><a href="/fis-site/docs/api/fis-conf.html#deploy">deploy</a></li><li class="item-category"><a href="/fis-site/docs/api/dev.html">插件开发API</a></li><li class="item-category"><a href="/fis-sitehttps://github.com/fex-team/fis/issues/new">问题反馈</a></li><li class="item-category"><a href="/fis-sitehttps://github.com/fex-team/fis/issues?labels=faq&page=1&state=open">FAQ</a></li></ul></nav><div class="bottom-shadow"></div></aside><div class="container"><article class="doc-content"><div class="toc affix"></div><h1>插件调用机制</h1><p>插件调用机制的 <a href="https://github.com/fis-dev/fis-kernel/blob/master/fis-kernel.js#L77-L86">实现</a> 非常简单：</p><p><img src="https://raw.githubusercontent.com/fouber/fis-wiki-img/master/fis.require.png" alt="fis.require实现机制"></p><p>fis的插件也是一个npm包，利用fis.require函数来加载。当我们在fis系统中加载一个插件的时候，会利用 <a href="http://nodejs.org/api/modules.html#modules_loading_from_node_modules_folders">nodejs的require向上查找机制</a> 从 <strong>fis-kernel</strong> 模块出发，向上查找所需模块，产生这样的效果：</p><p><img src="https://raw.githubusercontent.com/fouber/fis-wiki-img/master/fis.require2.png" alt="fis.require调用示意图"></p><p>fis插件系统巧妙的利用了nodejs的require机制来实现其扩展机制。这意味着，要想扩展fis可以有 <strong>三种途径</strong> ：</p><ol><li>使用fis的用户，自己需要某种插件，可以在fis安装目录的 <strong>同级</strong>，安装自己扩展的插件。比如： <code>bash npm install -g fis npm install -g fis-parser-coffee-script</code></li><li>fis团队会衡量某个插件的通用性，把它放到fis的依赖里，最优先加载。目前已经内置的插件包括：<ul><li><a href="https://github.com/fis-dev/fis-kernel">fis-kernel</a>：fis编译机制内核</li><li><a href="https://github.com/fis-dev/fis-command-release">fis-command-release</a>：fis release命令的提供者，处理编译过程，并提供文件监听、自动上传等功能</li><li><a href="https://github.com/fis-dev/fis-command-install">fis-command-install</a>：fis install命令的提供者，用于从fis仓库下载组件、配置、框架、素材等资源</li><li><a href="https://github.com/fis-dev/fis-command-server">fis-command-server</a>：fis server命令的提供者，用于开启一个本地php-cgi服务器，对项目进行预览、调试。</li><li><a href="https://github.com/fis-dev/fis-optimizer-uglify-js">fis-optimizer-uglify-js</a>：fis的优化插件，调用uglify-js对文件内容进行js压缩。</li><li><a href="https://github.com/fis-dev/fis-optimizer-clean-css">fis-optimizer-clean-css</a>：fis的优化插件，调用clean-css对文件内容进行css压缩。</li><li><a href="https://github.com/fis-dev/fis-postprocessor-jswrapper">fis-postprocessor-jswrapper</a>：fis的后处理器插件，用于对js文件进行包装，支持amd的define包装或者匿名自执行函数包装。</li></ul></li><li>开发一个依赖于fis模块的npm包，并在这个包里定制所需要的插件。这种方式与上一条类似，也是将插件安装在fis的同级目录下。</li></ol><!--  --><br><strong>有任何问题，请在 <a href="https://github.com/fex-team/fis/issues">https://github.com/fex-team/fis/issues</a> 讨论</strong></article><script type="text/javascript">$("a").each(function(t,r){0===$(r).attr("href").indexOf("/")?$(r).attr("href",""+$(r).attr("href")):0!==$(r).attr("href").indexOf("#")&&$(r).attr("target","_blank")});</script><script type="text/javascript" src="/js/document.js"></script></div></div><script type="text/javascript">var _bdhmProtocol="https:"==document.location.protocol?" https://":" http://";document.write(unescape("%3Cscript src='"+_bdhmProtocol+"hm.baidu.com/h.js%3F4206d67a3ea708c0d2a9354c8d88525f' type='text/javascript'%3E%3C/script%3E"));</script><!-- Latest compiled and minified JavaScript, requires jQuery 1.x (2.x not supported in IE8) --><!-- Placed at the end of the document so the pages load faster --><script src="/js/perfect-scrollbar.min.js"></script><script type="text/javascript">!function(){function e(e,n){var i=$('<div style="display:none;"/>').appendTo($("body"));i.html("<!--[if "+(n||"")+" IE "+(e||"")+"]><a>&nbsp;</a><![endif]-->");var o=i.find("a").length;return i.remove(),o}function n(){function e(){i||(console.log("enable"),i=!0,$(".sidebar").perfectScrollbar({wheelSpeed:10,wheelPropagation:!1}))}function n(){i&&(console.log("disable"),i=!1,$(".sidebar").perfectScrollbar("destroy"))}$(window).width()>760&&$(".sidebar").height()<$(".sidebar ul").height()?e():n()}var i=!1;e(8,"lte")||($(".sidebar").addClass("scrollbar"),n(),$(window).resize(n))}();</script></body></html>